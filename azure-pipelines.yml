trigger:
  branches:
    include:
      - master

pool:
  name: LocalPool
  demands: []

variables:
  DB_HOST: 'localhost'
  DB_NAME: 'proof'
  DB_USER: 'postgres'
  DB_PASS: '$(Arond1ght$)' # Usa variable secreta en producciÃ³n

steps:
- task: UseDotNet@2
  inputs:
    packageType: 'sdk'
    version: '9.0.x' # AsegÃºrate de usar la versiÃ³n que tienes instalada

- script: |
    echo "ðŸ”„ Restaurando dependencias..."
    dotnet restore
  displayName: 'Restore'

- script: |
    echo "ðŸ”§ Compilando proyecto..."
    dotnet build --configuration Debug
  displayName: 'Build'

- script: |
    echo "ðŸ“¦ Aplicando migraciones..."
    dotnet ef database update --project TestProjectCore --startup-project TestProjectCore
  displayName: 'EF Core Update'

- script: |
    echo "ðŸš€ Publicando aplicaciÃ³n..."
    dotnet publish -c Release -o $(Build.ArtifactStagingDirectory)
  displayName: 'Publish'
